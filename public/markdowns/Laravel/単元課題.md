# Laravel 単元課題

---

## 課題

課題はDBを使用したスケジュール管理Webアプリケーションの作成です。
ソースコードは以下のリポジトリをクローン（またはフォーク）して自由に使用してください。

[リポジトリ（Github）](https://github.com/tc-kinjo/laravel-task)  
[画面遷移図（Figma）](https://www.figma.com/file/p9vxIVcYeYEp92WFjiJ8v2/%E5%8D%98%E5%85%83%E8%AA%B2%E9%A1%8C%E7%94%BB%E9%9D%A2%E9%81%B7%E7%A7%BB%E5%9B%B3?node-id=0%3A1)

---

## 提出

課題のソースコードはGitHubで管理します。
自分のアカウントに課題用のリポジトリを作成し、リポジトリのURLを講師、及びアシスタントに通知してください。

提出期限、及びURLの通知方法については各教室の運用ルールに従ってください。

---

## テーブル定義

3つのテーブルを使用します。

* users
* categories
* schedules

それぞれのテーブルを作成するSQL文(DDL)を作成してください。
接続するデータベース名やユーザー名は任意です。
※課題用に新しく作成してかまいません。

usersテーブル

|論理カラム名|物理カラム名|型|制約|備考|
|:--|:--|:--|:--|:--|
|id|id|serial|primary key|
|ログインid|login_id|varchar(255)|unique, not null||
|パスワード|password|varchar(255)|not null||
|名前|name|varchar(255)|not null|
|登録日時|created_at|datetime||
|更新日時|updated_at|datetime||

categoriesテーブル

|論理カラム名|物理カラム名|型|制約|備考|
|:--|:--|:--|:--|:--|
|id|id|serial|primary key||
|名前|name|varchar(255)|not null|
|登録日時|created_at|datetime||
|更新日時|created_at|datetime||

schedulesテーブル

|論理カラム名|物理カラム名|型|制約|備考|
|:--|:--|:--|:--|:--|
|id|id|serial|primary key||
|ユーザーID|user_id|int|not null||
|カテゴリid|category_id|int|not null||
|タイトル|title|varchar(255)|not null||
|場所|place|varchar(1000)||
|内容|description|varchar(2000)||
|日付|date|datetime|not null|
|登録日時|created_at|datetime||
|更新日時|created_at|datetime||

DDL、及びテストデータを作成するSQL文は一つのファイルにまとめ、ソースコードを一緒にGitHubに含めてください。

また、テストデータを作成するSQLを作成した場合は、それもGitHubに含めてください。

---

## 基本課題

基本課題では以下の機能を実装します。

* ログイン
* ログアウト
* カレンダー表示
* 新規登録
* 更新
* 削除

---

### ログイン

IDとパスワードからusersテーブルを検索し、ログインを行います。

#### 画面定義

|項目名|項目ID|fromタイプ|初期値|最大桁数|必須|備考|
|:--|:--|:--|:--|:--|:--|:--|
|ログインID|login_id|text||20|〇|
|パスワード|password|password||50|〇|
|ログインボタン||button||||ログイン処理実行|

* ログイン処理
  * 入力されたIDとPASSを、usersテーブルのlogin_idとpasswordで検索し、一致するレコードを取得する
    * レコードが取得できた場合：ユーザー情報をセッションに保存し、メニュー画面に遷移する
    * レコードが取得できない場合：ログイン画面に戻り、「IDまたはパスワードが不正です」のエラーメッセージを表示する
* 必須入力チェック
  * IDが未入力の場合
    * エラーメッセージ「IDは必須です」を表示する
  * PASSが未入力の場合
    * エラーメッセージ「PASSは必須です」を表示する

---

### ログアウト

ヘッダーのログアウトボタンを押下すると、セッションを破棄しログイン画面にログアウト画面に遷移する。

---

### ヘッダー

ログイン中は、画面左上にユーザー名を表示されます。
ログイン時にユーザー情報をセッションに保持し、セッション情報をもとに表示させてください。

---

### カレンダー表示

今月のスケジュールをschedulesテーブルから取得し、カレンダーに表示します。

* カレンダー
  * 2022年6月のカレンダー日付をコードに直書きではなく、ループ処理で表示させるようにしてください。
* スケジュール表示
  * 日付に紐づくスケジュールのタイトルをリンク（スケジュール詳細ページに遷移する）で表示する。

---

### 新規登録画面

新規のスケジュールを登録します。

#### 画面定義

|項目名|項目ID|fromタイプ|初期値|最大桁数|必須|備考|
|:--|:--|:--|:--|:--|:--|:--|
|日付|date|date||〇||
|タイトル|title|text||255|〇||
|カテゴリ|category_id|select|||〇|categoriesテーブルから値を取得する|
|場所|place|text||1000|||
|内容|description|textarea||2000|
|登録ボタン||button||||登録処理を実行する|
|戻るボタン||button||||メニュー画面に戻る|

* 必須チェック
  * 必須項目が未入力で登録ボタン押下時は、「<項目名>は必須です」のエラーメッセージを表示する
* 登録ボタン押下時
  * 確認ダイアログを表示し、「登録」が押下された場合は登録処理に進む
  * 「戻る」が押下された場合は確認ダイアログを閉じる
* 戻るボタン押下時
  * メニュー画面に戻る
* 登録処理
  * schedulesテーブルに対して、画面項目に対応する値をセットしてレコードを登録する
  * 登録処理終了後は、「登録が完了しました」のメッセージを表示し、画面の入力値を初期化する

---

### スケジュール詳細画面

選択されたスケジュールの詳細情報を表示します。

|項目名|項目ID|対象カラム|備考|
|:--|:--|:--|:--|
|日付|date|schedules.date|「〇年〇月〇日」のフォーマットに変換する|
|タイトル|title|schedules.title||
|カテゴリ|category_id|schedules.category_id|categoriesテーブルから値を取得する|
|場所|place|schedules.place||
|内容|description|schedules.description||
|削除ボタン|||削除処理を実行する|
|編集ボタン|||編集画面へ遷移する|
|戻るボタン|||カレンダー画面に戻る|

* 戻るボタン
  * カレンダー画面に戻る
* 削除ボタン
  * 確認ダイアログを表示し、削除が押下された場合は、scheduleテーブルのidをキーにレコード削除し、カレンダー画面に戻る
  * 削除時にエラーが発生した場合は、詳細画面で「削除に失敗しました」のエラーメッセージを表示する
* 修正ボタン
  * スケジュール更新画面に遷移する

---

### 更新

既存のschedulesレコードの値を更新(update)します。

#### 画面定義

|項目名|項目ID|fromタイプ|初期値|最大桁数|必須|備考|
|:--|:--|:--|:--|:--|:--|:--|
|日付|date|date|schedules.date||〇||
|タイトル|title|text|schedules.title|255|〇||
|カテゴリ|category_id|select|schedules.category_id||〇|categoriesテーブルから値を取得する|
|場所|place|text|schedule.place||||
|内容|description|textarea|schedules.description|2000|〇||
|更新ボタン||||||更新処理を実行する|
|戻るボタン||||||カレンダー画面に戻る|

* 更新ボタン
  * idでschedulesレコードを更新する
  * 必須項目が未入力の場合は「<項目>は必須です」のエラーメッセージを表示する
  * 更新時にエラーが発生した場合、「更新時にエラーが発生しました」のエラーメッセージを表示する
  * 更新が正常に行われ場合は、「更新処理が完了しました」のメッセージを表示する
* メニューに戻る
  * メニュー画面に遷移する

---

## 発展課題

発展課題では、カレンダーを動的に表示できるように実装します。  
基本の実装では、同じ月のカレンダーしか表示することができません。  

* カレンダーの上に先月のカレンダーを表示するボタン、来月のカレンダーを表示するボタンを追加します。
* ボタンが押下されると画面遷移でカレンダー画面を再表示し、先月（または来月）のカレンダーを再描画します。
