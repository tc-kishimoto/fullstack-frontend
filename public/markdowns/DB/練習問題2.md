# DB_練習問題2

---

## SQL2

---

### 事前準備

データベース名は「db_exam」を使用してください。

priductsテーブルのレコードは以下の状態にしてください。
（スマホケースのpriceがNULLにならないように注意）

|id|product_name|price|category|
|:--|:--|:--|:--|
|1|チョコレート|180|1|
|2|緑茶|120|1
|3|ティッシュ|250|2|
|4|綿棒|80|2|
|5|ハンカチ|340|3|
|6|マグカップ|700|3|
|7|スマホケース|1200|3|

---

### テーブル作成

新しくテーブルを作成してください。
テーブル名は「sales」とし、仕様は以下の通りとします。

|カラム名|型|制約|説明|
|:--|:--|:--|:--|
|id|INT|PRIMARY KEY|主キー|
|sales_date|VARCHAR(10)||売上日|
|product_id|INT||商品id|
|quantity|INT||数量|

---

### データの登録

salesテーブルに以下のデータを登録してください.

|id|sales_date|product_id|quantity|
|:--|:--|:--|:--|
|1|2020/01/05|1|3|
|2|2020/01/05|5|1|
|3|2020/01/05|3|2|
|4|2020/01/06|4|1|
|5|2020/01/06|1|5|
|6|2020/01/06|2|3|
|7|2020/01/07|7|1|
|8|2020/01/08|6|2|
|9|2020/01/08|2|6|
|10|2020/01/08|1|2|

---

### 並び替え

1. productテーブルを、値段が安い順に並び替えてレコードを取得してください。

2. productテーブルを、値段が高い順に並び替えてレコードを取得してください。

---

### CASE式

CASE式を使って、productテーブルのカテゴリ名が表示された状態でレコードを取得してください。

|id|product_name|price|カテゴリ名|
|:--|:--|:--|:--|
|1|チョコレート|180|飲食|
|2|緑茶|180|飲食|
|3|ティッシュ|250|日用品|
|4|綿棒|80|日用品|
|5|ハンカチ|340|雑貨|
|6|マグカップ|700|雑貨|
|7|スマホケース|1200|雑貨|

---

### GROUP BY

1. productテーブルから、カテゴリごとのレコード数を取得してください。
なお、レコードはカテゴリ順に並ぶようにしてください。

2. salesテーブルから、日付ごとの合計数量を取得してください。
なお、レコードは日付順に並ぶようにしてください。

3. salesテーブルから、商品毎の合計数量を取得してください。
なお、レコードはproduct_idごとに並ぶようにしてください。

---

### JOIN

salesテーブルとproductテーブルを結合して、以下のような表示になるようにレコードを取得してください。（レコード数は一部省略）

|id|sales_date|product_id|商品名|quantity|
|:--|:--|:--|:--|:--|
|1|2020/01/05|1|チョコレート|3|
|2|2020/01/05|5|ハンカチ|1|
|3|2020/01/05|3|ティッシュ|2|
|4|2020/01/06|4|綿棒|1|

---

### JOIN2

salesテーブルとproductテーブルを結合して、商品の売上金額を取得してください。（値段×数量 で算出）（※レコード数は一部省略）

|id|sales_date|商品名|売上金額|
|:--|:--|:--|:--|
|1|2020/01/05|チョコレート|480|
|2|2020/01/05|ハンカチ|480|
|3|2020/01/05|ティッシュ|500|
|4|2020/01/06|綿棒|80|

---

### JOINとGROUP BY

結合と集約を使い、日付ごとの売上合計金額を算出してください。
※下の表はイメージです。合計金額はイメージと一致していなくても構いません。

|sales_date|売上合計金額|
|:--|:--|
|2020/01/05|1000|
|2020/01/06|2000|
|2020/01/07|3000|
|2020/01/08|4000|

---

### サブクエリ

サブクエリを使用して、 salesテーブルからカテゴリが1の商品のレコードを取得してください。
