# PHP基礎

---

## PHPとは

PHPはプログラミング言語のひとつです。

正式名称は「Hypertext Preprocessor」。

C言語で書かれたスクリプト言語です。

---

## PHPの特徴

コンパイルが不要で簡単に動かすことができるのが大きな特徴の一つです。

PHPはWebアプリケーションを開発するのに特化した言語です。

HTMLの中にPHPのソースコードを埋め込むことができ（テンプレートエンジンと呼ばれる技術）、Webサイト上で動的なコンテンツを生成することができます。

逆に、Webではない通常のGUIアプリ（デスクトップアプリ）を作成することはできません。

---

## PHPの動作環境

PHPを動作させるには、Webサーバーが必要になります。

Webサーバーには

- Apache
- Nginx
- IIS

などがあります。

Webサーバーさえインストールすれば、Windows、Mac、LinuxなどのOSで動作させることが可能です。

XAMPPをインストールした場合は、自動的にApacheがインストールされます。

---

## PHP公式ドキュメント

PHPの公式ドキュメントは以下のサイトから確認できます。

https://www.php.net/manual/ja/index.php

PHPは公式ドキュメントが非常に充実しており、日本語にも対応しているので、学習中わからなくなった場合には積極的に公式ドキュメントを活用してください。

---

## 基本的な書き方

ここからの内容はPHPの環境構築ができている前提で進めます

環境がまだ作成していない場合は、環境構築の手順に従ってXAMPP、Google Chrome、VS Codeをインストールしておいてください。

XAMPP環境でなくても構いませんが、その場合は環境に関する部分は適宜読み替えてください。

まずは、VS Codeを使用してドキュメントルート(htdocs)配下に「info.php」を作成してください。

VS Codeでドキュメントルートのフォルダを開き、VS Code上のエクスプローラから新規ファイルを作成します。

info.php

```php
<?php
phpinfo();
?>
```

---

プログラムを書き終えたらブラウザから下記のURLにアクセスしてください。

http://localhost/info.php

localhostは自分自身のコンピュータのことを指します。

※環境によってはlocakhostの後にポート番号の指定が必要になることがあります。

以下のようなPHPの情報を示す画面が表示されれば成功です。

PHPのバージョンなどの詳細についてはXAMPPのバージョンにより異なります。

![picture 1](/images/0f477801bfc3f33e469978db74bda9926971d4d1e5b0cb4a549574f8d57e2add.png)  

---

内容の確認していきます。

PHPのプログラムのファイルの拡張子は.phpになります。

PHPのプログラムは

```php
<?php  …  ?>
```

に囲まれた部分に記述します。

* 文の終わりには;（セミコロン）を付けます。
* phpinfo()は、現在のPHPの情報を出力する命令（関数）です。
* ちなみに、最後の「?>」は省略してもプログラムは実行されます。
* ただし、ファイルの中身がPHPのプログラムだけの場合に限ります。（HTMLに組み込む場合などには省略できない）

---

PHPのプログラムだけを書く場合は通常省略します。

info.php

```php
<?php
phpinfo();
```

---

## プログラムのエラー

プログラムを書くときには、文法が間違えていたり、存在しない命令を書いたりするとエラーが起きます。

「phpinfo();」を「phpimfo();」に変更し、あえて間違えたコードを書いて、ブラウザで確認してみましょう。

info.php

```php
<?php
phpimfo();
```

以下のような画面になった場合は、エラー内容が表示されない設定になっています。

環境構築の手順に沿ってエラーが表示されるように設定してください。

![picture 2](/images/949049d5d47b7e5889589fcbe9b32a63797a1251c1c8d032bc0a9c7cef9edc3e.png)  

---

設定がうまくいけば、以下のようにエラーメッセージが表示されるようになります。

メッセージには、phpimfo()という関数は定義されていないという旨が書かれています。

![picture 3](/images/6d17d4150326d74fc8d46ee17e4d215f27c7eb976460d7106ef3ecd06ee3141f.png)  

エラーが表示された場合には、慌てずにその内容をよく読む癖をつけましょう。
エラーが出てもPCやプログラム自体が壊れてしまうことはありません。
冷静に対処できるようにしましょう。

---

## 画面への出力

画面に文字や数値を出力してみましょう。

以下のプログラムを作成して実行結果を確認してください。

disp.php

```php
<?php
echo "Hello World!<br>";
echo 'こんにちは!<br>';
echo 100;
```

結果

```text
Hello World!
こんにちは!
100
```

---

まず、ブラウザ上で値を出力するには、「echo」という命令を使用します。

文字列は、”（ダブルクォーテーション）、または’（シングルクォーテーション）で囲います。（両者の違いについては後の単元で解説します。今の時点では出力結果に違いはありません。）  
数値についてはそのまま記述します。

文字列の後ろにbrタグを記述しているのは、出力した文字を改行されるためです。

ブラウザ上で表示させるため、改行して表示させるためには`<br>`タグを使用します。

---

別の出力方法も紹介しておきます。

「echo」を「print」に変更したプログラムを作成し、結果を確認してください。

print.php

```php
<?php
print "Hello World!<br>";
print 'こんにちは!<br>';
print 100;
```

同じ結果になるはずです。

画面に出力する方法は、「echo」と「print」の2つがあります。

厳密にはechoとprintは処理に若干違いがありますが、出力結果としては変わりません。どちらを使用しても構いませんが、このテキストでは基本的に「echo」を使用します。

---

echoやprintは以下のように括弧に入れることも可能です。

disp2.php

```php
<?php
echo("Hello World!<br>");
print("Hello World!<br>");
```

また、出力のみをしたい場合は、以下のような書き方もできます。併せて覚えておきましょう。

disp3.php

```php
<?= "Hello World!" ?>
```

---

echoでは、「,」(カンマ)区切りで出力したい値を連続して書くこともできます。

disp4.php

```php
<?php
echo "Hello ", "World!" ,"<br>";
```

結果

```text
Hello World!
```

---

## コメント

コメントは、プログラムの処理に影響を与えない記述です。

プログラムの補足情報を残したい場合などによく使用されます。

PHPではコメントは3種類の書き方が用意されています。


comment.php

```php
<?php
// ①1行コメント
echo "おはよう"; // echoによる出力
#  ②1行コメント
print "こんにちは"; # printによる出力
/* 
    ③複数行コメント
*/
```

①と②は1行のみのコメントです。1行コメントは2通りの書き方があり、「//」または「#」を使用します。両者に違いはありません。このテキストでは「//」を使用してきます。

③は複数行をまとめてコメントします。「/* 」と「 */」がそれぞれコメントの開始と終了になります。

---

## コメントアウト

コメントは主にコースコードの補足情報を書きたい場合などに使いますが、の処理を一部無効化したい場合にもソースコードをコメントにする場合があります。

ソースコードの処理を無効化するためにコメントにすることを**コメントアウト**と呼びます。

VS Codeを使用している場合、ソースコードの中でコメントアウトしたい行を選択し、「Ctrl + /」押下で、コメントアウトを行う事ができます。

逆に、コメントアウトされた行を選択して「Ctrl + /」とすると、コメントを解除する事ができます。

---

## 変数

### 変数とは

変数とは、簡単に言うと「データを保持しておく入れ物」です。

パソコンで作業していて、操作を間違えた時、「元に戻す」機能を使って、間違えた作業をなかったことにしたりします。

コンピュータでプログラムを動かすときには、一時的にデータを保持しておかなければならない状況が多く存在します。その際に使用するのは「変数」と呼ばれるものです。

変数はメモリ上に保持されます。

---

## 変数名のルール

変数は、プログラムの中で何個でも作ることができます。そのため、変数を区別するため変数に名前を付ける必要があります。付けた名前を「変数名」といいます。

変数名の付け方には以下のルールがあります。

1. 先頭が$で始まる
2. アンダースコア（_）と英数字のみ使用可能
3. $の次に数字は使えない

また、大文字と小文字は区別されますので注意しましょう。

例）

* $name1 ⇒  ○
* $userName ⇒  ○
* $123 ⇒  ×（＄の次に数字は使えない）
* $a-b ⇒  ×（アンダースコア（_）以外の記号は使えない）

---

また、プログラムの可読性を上げるために（プログラムを読みやすくするために）変数名は以下のことを意識しましょう。

1. 中身がイメージできる名前を付ける
2. 最初の文字は小文字
3. 英単語の区切りごとに大文字で表記する

例) userName, userId など

※このような書き方をキャメルケースといいます。

---

## 変数の使い方

では変数の使い方を見ていきましょう。

以下のファイルを作成し、実行結果を確認してください。

variable.php

```php
<?php
$num = 10;
echo $num;
```

---

一つずつ確認していきましょう。

まず、最初に「$num」という変数を定義しています。

```text
$num = 10;
```

次に「=」ですが、これは「代入演算子」と呼ばれるものです。算数や数学では、「=」は「右辺と左辺が等しい」という意味で使われましたが、プログラミングでは「右辺の値を左辺に代入する」という意味で使用されます。

つまりここでは、「$numという変数に10を代入している」という意味になります。
そして「echo $num;」で、10の値が出力されています。

```text
echo $num;
```

変数を出力することで、変数に格納されている値を参照することができます。

---

次に、以下のファイルを作成して実行結果を確認してみましょう。

variable2.php

```php
<?php
$num = 10;
echo $num;
$num = 20;
echo $num;
```

結果

```text
1020
```

このように、変数の値は上書きして書き換えることができます。

また、同じ変数は何度でも参照して使用することが可能です。

---

次は、値を何も代入していない変数を出力しようとした場合にどうなるかを見てみましょう。

以下のプログラムを作成して実行結果を確認してみましょう。

variable3.php

```php
<?php
$num = 10;
echo $number;  // 何も代入していない
```

以下のようなエラー（警告）になります。

値が何も代入されていない変数を使用した場合にはエラーになるので注意してください。

```text
Notice: Undefined variable: number in /var/www/html/variable3.php on line 3
```

---

## 数値と演算子

### リテラル

「10」「"Hello"」のように、プログラムの中に直接記述された値のことをリテラルといいます。

値が数値のリテラルを、「数値リテラル」文字列のリテラルを「文字列リテラル」といいます。

```php
<?php
echo 10;      // 数値リテラル
echo "Hello"; // 文字列リテラル
```

PHPでは、整数、小数を数値として扱えます。

```php
<?php
$plus  = 10;   // プラス
$minus = -20;  // マイナス
$pi    = 3.14; // 小数
```

---

### 演算子

プログラミングでは「=」は、「代入演算子」と学習しました。

PHPでは「代入演算子」以外にも、計算を行う「算術演算子」や「比較演算子」「論理演算子」など、様々な演算子があります。

ここでは、数値の計算を行うための演算子「算術演算子」についてみていきます。

---

### 算術演算子

まずは四則演算からです。

* 足し算：「+」
* 引き算：「-」
* 掛け算：「*」
* 割り算：「/」

となります。

掛け算と割り算は数学とは記号が違うので注意しましょう。

---

arithmetic1.php

```php
<?php
echo 10 + 20, '<br>';  // 足し算
echo 30 - 100, '<br>'; // 引き算
echo 8.5 * 9, '<br>';   // 掛け算
echo 10 / 3, '<br>';    // 割り算
```

結果

```php
30
-70
76.5
3.3333333333333
```

どちらかが小数になっている場合は、結果も小数になります。

ただし、割り算の場合は両方が整数でも結果が小数であれば、結果は小数になります。


---

次に四則演算以外の算術演算も確認してみます。


余り：「%」

べき乗：「**」

arithmetic2.php

```php
<?php
echo 10 % 3, '<br>'; // 余り
echo 2 ** 3;      // べき乗
```

結果

```text
1
8
```

---

演算子には、優先順位が存在します。

以下のプログラムを確認してみましょう。結果は「8」になります。これは「2 * 3」と「4 / 2」が先に計算されて、その結果を足しているからです。

```php
<?php
echo 2 * 3 + 4 / 2;
```

結果

```text
8
```

計算を行うときは「掛け算と割り算」は「足し算と引き算」よりも優先順位が高いと覚えておきましょう。

これは数学と同じ考えになります。

その他の演算子と優先順位の関係は、公式マニュアルを参照してください。

https://www.php.net/manual/ja/language.operators.precedence.php

---

優先順位を変更するには、()で先に計算したい箇所を囲うことで、優先して計算させることができます。

```php
<?php
echo 2 * (3 + 4) / 2;
```

結果

```text
7
```

---

### 代入演算子

変数に値を上書きする際、元の変数の値を使用して値を上書きすることができます。

---

arithmetic3.php

```php
<?php
$num = 10;
$num = $num + 5;  // 5を加算
echo $num, '<br>';
$num = $num - 5;  // 5を減算
echo $num, '<br>';
$num = $num * 5;  // 5を乗算
echo $num, '<br>';
$num = $num / 5;  // 5で除算
echo $num, '<br>';
$num = $num % 3;  // 3の乗除
echo $num;
```

結果

```text
15
10
50
10
1
```

---

これにはもっと簡単な書き方があります。
以下のように修正してみます。

```php
<?php
$num = 10;
$num += 5; // $num = $num + 5; // 5を加算
echo $num, '<br>';
$num -= 5; // $num = $num – 5; // 5を減算
echo $num, '<br>';
$num *= 5; // $num = $num * 5;  // 5を乗算
echo $num, '<br>';
$num /= 5; // $num = $num / 5;  // 5で除算
echo $num, '<br>';
$num %= 3; // $num = $num % 3;  // 3の乗除
echo $num;
```

同様の結果が得られます。

このような「=」と算術演算子を合わせた代入演算子もよく使用しますので、合わせて覚えておきましょう。

---

### 単項演算子

最後に単項演算子というものを見ていきます。
変数に1を加算したい、または１減らしたい場合、代入演算子を使って以下のように書くことで実現できます。

arithmetic4.php

```php
<?php
$num1 = 10;
$num2 = 10;
$num1 += 1;
$num2 -= 1;
echo $num1, '<br>';
echo $num2, '<br>';
```

結果

```text
11
9
```

---

これはもっと簡単に書くことができます。
以下のプログラムを確認してください。

```php
<?php
$num1 = 10;
$num2 = 10;
$num1++; // インクリメント // $num1 += 1;
$num2--; // デクリメント　　// $num2 -= 1;
echo $num1, '<br>';
echo $num2, '<br>';
?>
```

「++」や「--」といった演算子を使用することで、1を加算したり減算することができます。

「++」のことを、「**インクリメント**」、「--」のことを「**デクリメント**」といいます。

これらを合わせて「**単項演算子**」といいます。

インクリメントやデクリメントは繰り返し処理を行う際によく使用されます。

---

## 文字列

PHPでは、文字列を表すのに"(ダブルクォーテーション)を使用する方法と'(シングルクォーテーション)を使用する方法があると学びました。

まずはこの違いから見ていきます。以下のプログラムを見てみましょう。

greet.php

```php
<?php
echo "おはよう";
echo 'こんにちは';
```

結果

```text
おはようこんにちは
```

結果を見てもこれだけでは違いは分かりません。

---

### 変数展開

以下のように修正して実行結果を確認してみます。

```php
<?php
$name = "佐藤";
echo "おはよう $name さん<br>";
echo 'こんにちは $name さん';
```

結果

```text
おはよう 佐藤 さん
こんにちは $name さん
```

結果は、シングルクォーテーションの方は、「$name」がそのまま文字列として出力されていますが、ダブルクォーテーションの方では、変数の値が出力されています。

このような仕組みを**変数展開**と呼びます。ダブルクォーテーションでくくった文字列は、変数展開がされるようになっています。

---

ちなみに、以下のように変数と文字列の間にスペースを入れなかった場合はどうなるでしょうか。

```php
<?php
$name = "佐藤";
echo "おはよう$nameさん<br>";
echo 'こんにちは$nameさん';
```

結果

```text
Notice: Undefined variable: nameさんin /var/www/html/greet.php on line 3
おはよう
こんにちは$nameさん
```

エラーになってしまいます。
スペースを入れない場合は、{}(中括弧)で変数をかこってあげるとうまくいきますので、覚えておきましょう。

```php
<?php
$name = "佐藤";
echo "おはよう{$name}さん<br>";
echo 'こんにちは{$name}さん';
```

---

### 文字列結合

文字列同士を結合して別の文字列を作ることも可能です。

文字列の連結は .(ピリオド)を使用します。

join1.php

```php
<?php
$greet = "こんにちは、";
$name = "佐藤さん";
echo $greet . $name;
```

代入演算子での文字列の結合も可能です。

代入演算子では「.=」を使用します。

join2.php

```php
<?php
$greet = "こんにちは";
$greet .= "佐藤さん";
echo $greet;
```

---

### エスケープシーケンス

文字列の中、「"」や「'」などの特殊な記号を使用したい場合はどのようにすればよいでしょうか。
例えば、以下のプログラムを実行してみます。

escape.php

```php
<?php
echo ""Hello"";
echo ''World'';
```

結果

```text
Parse error: syntax error, unexpected 'Hello'(T_STRING), expecting ',' or ';' in /var/www/html/escape.php on line 2
```

エラーになりました。

---

このエラーを解決するためには、記号の前に「\」を入れます。

環境によってはバックスラッシュ記号になります。

バックスラッシュや「\」マークを使って特殊な記号を表す方法を「**エスケープシーケンス**」といいます。

```php
<?php
echo "\"Hello\"";
echo '\'World\'';
```

結果

```text
"Hello"'World'
```

「$」を文字列として扱いたい場合にもエスケープシーケンスを使用します。

```php
<?php
$age = 20;
echo "\$age = {$age}";
```

```text
$age = 20
```

---

なお、ダブルクォーテーションの文字列の中でシングルクォーテーションを使用する場合、またはシングルクォーテーションの文字列の中でダブルクォーテーションを使用する場合は、そのまま使用できます。

```php
<?php
echo "'Hello'";
echo '"World"';
```

```text
'Hello'"World"
```

---

その他、改行やタブを表すエスケープシーケンスも存在します。

改行：「\n」、タブ「\t」など。

このような特殊文字は、ダブルクォーテーションでの文字列でしか使用できないので注意しましょう。

```php
<?php
echo "<pre>";
echo "He\tllo \n World";
echo "</pre>";
```

結果

```php
He llo
World
```

---

### ヒアドキュメント

長い文字列を使用したいとき、ヒアドキュメントという手法を使うと便利です。「TEXT」の部分は任意の文字を指定できます。ただし開始と終了を一致させる必要があります。その間に挟まれた内容が一つの文字列としてみなされます。ヒアドキュメントの中での変数展開も可能です。

```php
<?php
$color = <<<TEXT
<p>red</p>
<p>green</p>
<p>blue</p>
<p>yellow</p>
<p>black</p>
TEXT;
echo $color;
```

結果

```text
Red

Green

Blue

Yellow

black
```

---

## 講義動画

[PHP基礎](https://youtu.be/8e0NwW-Jg7E)
