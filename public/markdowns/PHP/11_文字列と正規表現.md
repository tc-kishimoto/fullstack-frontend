# 文字列と正規表現

---

## 文字列とデータ型

これまで'（シングルクォーテーション）や"（ダブルクォーテーション）で囲われた値のことを文字列と呼んでいましたが、厳密には1文字の場合は「文字」複数の文字が連結されたものを「文字列」と呼んだりします。
ただしプログラミング上、'や"で囲われた値は、1文字の場合でも２文字以上の場合でも文字列と呼びます。
0文字の場合は空文字と呼ばれることもあります。
PHPをはじめとする多くのプログラミング言語では、文字列のことを「string」と呼びます。

---

stringは、PHPのデータ型の一つです。
データ型とは、データ（値）の種類のことです。
PHPのデータ型には以下のような種類があります。

* 整数：int
* 小数：float
* 真偽値：boolean
* 文字列：string
* 配列：array

PHPでは他にも様々なデータ型が存在します。
オブジェクト指向を学習すると自分で型（クラス）を定義できるようになるため、型の種類は無数に存在します。

---

## 文字列を扱う関数

文字列を扱った処理はプログラミングの中でも頻繁に行われます。
ここでは文字列を操作するときに使用する関数の一部を紹介します。

---

### strlen()関数

文字列の長さを取得するにはstrlen()関数を使用します。

```php
<?php
$str = "absde";
echo strlen($str);
```

結果

```text
5
```

---

### strtolower()関数、strtoupper()関数

文字列を小文字に変換するにはstrtolower()関数、大文字に変換するにはstrtoupper()関数を使用します。

```php
<?php
$str1 = "ABC";
$str2 = "def";
echo strtolower($str1), strtoupper($str2);
```

結果

```text
abcDEF
```

---

### trim()関数

文字列の先頭と末尾の空白を削除するには、trim()関数を使用します。

```php
<?php
$str1 = "  abc  ";
$str2 = "  123  ";
echo trim($str1) , trim($str2); 
```

結果

```text
abc123
```

---

### substr()関数

文字列の一部分を切り取りたい場合には、substr()関数を使用します。
一番目の引数には対象の文字列を、二番目の引数には切り取りの開始位置を、三番目の引数には切り取る文字数の長さを指定します。
開始位置は0番目が１文字目にあたります。

```php
<?php
$str = "abcdefg";
echo substr($str, 1, 3);
```

結果

```text
bcd
```

---

### strpos()関数

文字列の中から特定の文字を検索し、場所を特定するにはstrpos()関数を使用します。
一番目の引数には対象の文字列を、二番目の引数には検索対象の文字列を指定します。

```php
<?php
echo strpos('abcdefg', 'cd');
```

結果

```text
2
```

---

### str_repeat()関数

同じ文字列を繰り返したい場合にはstr_repeat()関数を使用します。
一番目の引数には対象の文字列を、二番目の引数には繰り返したい数を指定します。

```php
<?php
echo str_repeat('abc', 5);
```

結果

```text
abcabcabcabcabc
```

---

ここで紹介した以外にも文字列操作に関する関数は多数存在します。
詳しくは公式サイトを確認して下さい。
公式サイトの説明だけで動作が理解できない場合は、自分で実際にプログラムを書いて色々と試してみることをおすすめします。

https://www.php.net/manual/ja/ref.strings.php

## マルチバイト文字

strlen()関数を使って日本語が含まれる文字列の長さを取得するとどうなるでしょうか。

```php
<?php
$str = "あいうえお";
echo strlen($str);
```

結果

```text
15
```

通常、数字やアルファベットは１バイトで表現することができますが、日本語は２バイト以上で表現されます。
２バイト以上で表現される文字のことをマルチバイト文字と呼びます。
先程の例で想定外の結果が出力されたのは、strlen関数がマルチバイト文字に対応する処理になっていないためです。
PHPでは、マルチバイト文字を処理する場合の関数が別途用意されています。

---

### mb_strlen()関数

マルチバイトを含む文字列で文字数を取得したい場合は、mb_strlen()関数を使用します。

```php
<?php
$str = "あいうえお";
echo mb_strlen($str);
```

結果

```text
5
```

---

マルチバイトの関数についても、詳しく公式サイトを参照ください。

https://www.php.net/manual/ja/ref.mbstring.php

基本的に、マルチバイト文字を扱う関数については、通常の文字列の関数名の先頭に「mb_」という接頭子がつく形になります。
日本で開発されるシステムでは、多くの場合日本語を使用することになるので、文字列操作はマルチバイト文字の関数を使用することになるでしょう。

## 正規表現

正規表現は、文字列を特定のパターンで検索する場合などに使用される表現方法です。
例えば、郵便番号は「3桁の数字 - 4桁の数字」で表現されます。
正規表現は郵便番号、電話番号、メールアドレスのように、特定のフォーマットで表される文字列の検索やチェックなどで使用されます。

正規表現の表現方法については、ネットでわかりやすく解説しているサイトが多数ありますので、そちらを参照ください。

https://murashun.jp/article/programming/regular-expression.html

※正規表現はほとんどのプログラミング言語でサポートされていますが、書き方にはほとんど差はありませんので、PHP以外の言語で解説しているサイトでも参考になります。

---

### preg_match()関数

PHPで正規表現のチェックを行うには、preg_match()関数を用います。
第一引数に文字のパターンを、第二引数にチェック対象となる文字を渡します。
パターンに合致する場合はtrue、合致しない場合はfalseとなります。
第一引数のパタンは、/パターン/ のように書きます。

詳しい使い方は公式サイトを参照

https://www.php.net/manual/ja/function.preg-match.php

---

### preg_match()関数のサンプル

数字3桁になっているかを調べるコードです。

```php
<?php
$num = "123";
if(preg_match('/[0-9]{3}/', $num)) {
    echo "数字3桁です";
}else{
    echo "数字3桁ではありません";
}
```

結果

```text
数字3桁です
```

---

正規表現はPHPだけではなく、様々なプログラミング言語でサポートされています。
また、VS Codeなど、テキストエディタの検索でも使用することもできます。
知っておくと活用できる場面は多いので、概要を理解しておきましょう。

---

## まとめ

文字列のことをstringと呼ぶ。
日本語のような、２バイト以上で表現される文字のことをマルチバイト文字と呼ぶ。
PHPではマルチバイト用の関数として、「mb_」から始まる関数が多数用意されている。
文字列を特定のパターンに合致するかを調べるときの表現方法に正規表現がある。
PHPで正規表現を扱うときにはpreg_match()関数を使う。
