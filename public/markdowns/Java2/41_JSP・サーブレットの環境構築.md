# JSP・サーブレットの環境構築

---

JSP/サーブレットを利用するには、Javaの動作環境(JDK)とAPサーバー(Tomcat)の環境が必要になります。
JSP/サーブレットの動作環境はVS Codeでも作成することが可能ですが、IDE(eclipse)を使用したほうが楽なので、IDEを使用することを推奨します。

## IDEによる環境構築

IDEとは、統合開発環境と呼ばれる、開発に必要なツール群がひとまとまりになっているソフトウェアです。
ここではJavaのIDEとしてよく利用されているEclipseでの手順を紹介します。

eclipseの環境がない場合は[https://mergedoc.osdn.jp/](https://mergedoc.osdn.jp/)
からダウンロードしてください。
様々なバージョンがありますが、基本的に最新バージョンで問題ありません。
Javaの「Full Edition」を使用しているOSに合わせてダウンロードしてください。
Full Editionをダウンロードした場合、JDKやTomcatが既に含まれているため、特別な設定は不要です。
eclipse内でJavaやTomcatのバージョンの設定をすれば動作させることが可能です。

起動したら新規プロジェクトで「動的Webプロジェクト」を選んで作成します。
動的プロジェクトは、「ファイル」⇒「新規」⇒「その他」⇒「Web」⇒「動的Webプロジェクト」から選択できます。
プロジェクト名は任意です。
プロジェクト作成時のダイアログにある「ターゲット・ランタイム」でTomcatのバージョンを指定できます。
最新のもの(これを書いてる時点ではTomcat9)を選んで問題ありません。
プロジェクトが作成できたら、「WebCondent」フォルダの配下にJSPファイルを作成します。
JSPファイルは、WebContentフォルダを選択し、「右クリック」⇒「新規」⇒「その他」⇒「Web」⇒「JSPファイル」から作成できます。

## VS Codeによる環境構築

VS Codeによる環境構築方法も紹介しておきます。
まずはVS CodeでTomcatの拡張機能をインストールします。
拡張機能で「Tomcat for Java」をインストールします。
Tomcatを使用するにはTomcatのファイルが必要になります。
公式サイト

[http://tomcat.apache.org/](http://tomcat.apache.org/)
からダウンロードしておきましょう。
Javaのバージョンによって対応しているバージョンが異なりますが、[http://tomcat.apache.org/whichversion.html](http://tomcat.apache.org/whichversion.html)
で対応バージョンを確認してダウンロードしておきましょう。
※Javaの環境構築に関してはJava入門(導入～メソッド)の記事を参照ください。

zipファイルをダウンロードして、適当な場所(Cドライブ直下など)に展開しておいてください。

コマンドパレット(Ctrl + Shift + p)を開き、
Tomcat: Add Tomcat Server
を選択し、あらかじめ展開していたTomcatサーバーを指定します。

追加したら左の「TOMCAT SERVER」ペインで確認できます。
コマンドパレットから
Tomcat: Start Tomcat Server
でサーバーが起動します。
ブラウザから
localhost:8080
にアクセスしてTomcatの画面が表示されたらAPサーバーの確認はOKです。

Tomcatの確認ができたらJavaのプロジェクトを作成していきます。
コマンドパレット(Ctrl + Shift + p)から「java:Create Java Project」を選択し、Javaプロジェクトを作成します。
プロジェクトのフォルダ直下にJSPファイルを作成します。

ソースの作成が完了したらコマンドパレットから
Tomcat: Generate War Package From Current Folder
を選択します。
プロジェクトの直下にwarファイルが作成されます。
warファイルが作成されたら、コマンドパレットから
Tomcat: Run on Tomcat Server
を選択し、追加したTomcatサーバーにwarファイルをデプロイします。

うまくいけばブラウザから
loaclhost:8080/プロジェクト名/JSPファイル名
でアクセス可能になります。

※TODO
Mavenでの作成でもっと簡単にできる方法がありそうだけど試してもできなかったので
そのうちできたら追記。

### warファイル

VS CodeでJSPを実行する際に「warファイル」と呼ばれるファイルが出てきました。
このファイルについても説明しておきます。
JavaでのWebアプリケーションの開発が完了したら、作ったプログラムを実際にWebアプリケーションを動かすサーバー上に置いて動かせるようにしなければいけません。
この作業のことをデプロイとよびます。
Javaで書いたソースコードは実際にプログラムを動かすときには不要です。(コンパイルされたclassファイルがあれば動く)
そのため、開発するときに必要なファイルと、実際に動作させるときに必要なファイルは必ずしも一致しません。
そこで、サーバー上に配置するだけで動くように、必要なファイルを決められたフォルダ構成でまとめられたファイルがwarファイルです。
warファイルは実際にはただの圧縮ファイルです。
そのため、出力されたwarファイルの拡張子をzipなどに変更し、展開することで中身を確認することができます。

TODO

- VS CodeでのJSPのデバッグ方法
