# CentOS環境構築手順

---

## 概要

CentOSの環境を作成します。
仮想マシンソフトであるVirtual Boxを使用します。
VirtualBox上にCentOS環境を構築し、ホストOS(Windows上)からssh接続します。

---

## VirtualBoxのインストール

下記のサイトからVirtualBoxのインストーラをダウンロードします。

[VirtualBox](https://www.oracle.com/jp/virtualization/technologies/vm/downloads/virtualbox-downloads.html)

ダウンロードが完了したら、インストーラの指示に従ってインストールします。

---

## CentOSのイメージファイルのダウンロード

下記のサイトからCentOSのイメージファイルをダウンロードします。
※ダウンロードには時間がかかります。

[CentOS ダウンロード](https://www.centos.org/download/)

複数のバージョンがありますが、CentOS Stream の バージョン8を選択します。

ミラーサイトから

```text
CentOS-Stream-8-x86_64-20220310-boot.iso
```

などのファイルをダウンロードします。

---

## CentOSの環境構築

1. VirtualBoxを起動
2. 「新規」ボタン押下
   * 名前：任意。例：「CentOS 8」など
   * マシンフォルダー：デフォルト
   * タイプ：Linux
   * バージョン：Red Hat(64-bit)
3. メモリサイズ：デフォルト(1024MB)
4. ハードディスク：デフォルト(仮想ハードディスクを作成) ⇒ 「作成」
5. ハードディスクのファイルタイプ：デフォルト(VDI) ⇒ 「次へ」
6. 物理ハードディスクにあるストレージ：デフォルト(可変サイズ) ⇒ 「次へ」
7. ファイルの場所とサイズ：デフォルト　⇒ 「作成」

---

1. 一覧に追加された「CentOS 8」を選択
2. 「設定」押下でダイアログ起動
3. ストレージを選択
4. コントローラ: IDEのディスクを選択
5. 光学ドライブのディスクマークを選択
6. 仮想高額ディスクの選択を押下
7. 追加 ⇒ ダウンロードしたCentOSのisoファイルを選択
8. OK押下で設定ファイアログを閉じる

---

1. 「起動」押下で仮想マシンを起動
2. 「Install CentOS Stream-8」を選択してEnter
3. 言語選択「日本語」選択
4. デバイスの選択
5. ネットワーク有効か
6. ソフトウェアの選択 ⇒ 最小限のインストール
7. rootユーザーのパスワードの設定：任意「root」とかで適当に
8. 「インストール開始」でインストール終了するまで待つ。
9. 完了したら再起動
10. VirtualBox上でrootユーザーでログインできることを確認

---

## ポートフォワーディングの設定

1. VirtualBoxで仮想マシンの設定画面を開く
2. ネットワークを選択
3. アダプター1（割り当て：NAT）を選択し、「高度」を開く
4. ポートフォワーディング押下 ⇒ ウィンドウが起動する
5. ポートフォワーディングルールを追加
6. 名前：ssh、プロトコル：TCP、ホストポート：2222、ゲストポート：22
※IPは空白でOK。ホストポートの2222は使用してないポートであれば何でもOK

---

## sshの接続

1. コマンドプロンプトを起動
2. sshコマンドを実行（コマンドが見つからない場合は設定を行う）
   * Windowsの設定から「オプション機能の管理」を開く
   * 機能の追加から、OpenSSHクライアントを追加
3. sshコマンドを入力してCentOSに接続

```bash
ssh root@localhost -p 2222
```
