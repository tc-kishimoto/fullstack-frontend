# 条件分岐

---

## If文

if文は、条件分岐を可能にする構文です。

日本語で説明すると「もし○○なら□□する」といった内容になります。

フローチャートで表現すると以下のようになります。

![picture 13](/images/e44746b13cb7b286d78a033a59659310a09665b2a1c52fb4f392f54a30fc2457.png)  

---

if文の書き方は以下のようになります。

```php
if(条件式) {
    処理
}
```

条件式には、真(true) または 偽(false)のいずれかの結果を返す式を記述します。

処理には、条件式が真の時に実行される処理を記述します。

{}に囲まれた部分のことをブロックと呼びます。

ブロックの中は、ソースコードを読みやすくするためにスペースを空けるのが一般的です。

このスペースのことをインデント（字下げ）と呼びます。

処理が1行の場合は{}を省略することも可能です。

```php
if (条件式)
    処理
```

ただし、可読性が悪くるので、処理が1行の場合でも基本的には{}を記述する方が良いでしょう。


---

ではさっそくif文の例を見ていきましょう。以下のプログラムを作成して確認してください。

if.php

```php
<?php
$score = 75;
echo "スコアは{$score}点です。<br>";
if ($score >= 70) {
    echo "よくできました。";
}
```

スコアが70点以上の場合は、「よくできました。」と出力するプログラムです。

結果

```text
スコアは75点です。
よくできました。
```

スコアは75点なので、「よくできました。」と表示されているのが確認できます。

---

次は、先ほどのプログラムの$scoreの値を60に変更して実行してみましょう。

```php
<?php
$score = 60;
echo "スコアは{$score}点です。<br>";
if ($score >= 70) {
    echo "よくできました。";
}
```

結果

```text
スコアは60点です。
```

条件を満たさないため、「よくできました。」が表示されないのが分かります。

---

## 比較演算子

先ほどの例のif文の条件の中で「>=」という記号を使用しました。

これは「比較演算子」と呼ばれる演算子で、条件式の中で値を比較する際によく使用されます。

---

比較演算子には以下のようなものがあります。

| 演算子 | 意味 | 結果がtrueになるとき |
| --- | --- | --- |
| == | 値が等しい | 左辺と右辺が同じとき |
| === | 値と型が等しい | 左辺と右辺が同じとき |
| !==, <> | 値、または型が等しくない | 左辺と右辺が異なるとき |
| !== | 値、または型が等しくない | 左辺と右辺が異なるとき |
| >= | 以上 | 左辺が右辺以上のとき |
| <= | 以下 | 左辺が右辺以下のとき |
| > | より大きい | 左辺が右辺より大きいとき |
| < | より小さい | 左辺が右辺より小さいとき |

---

比較演算子の例を見ていきましょう。一つずつ確認してみてください。

```php
1 == 1      // 真(true)
"a" == "a"  // 真(true) 文字列の比較も可能
1 == 2      // 偽(false)
1 != 1      // 偽(true)
"a" != "b"  // 真(true)
1 != 2      // 真(false)
5 >= 5      // 真(true)
5 > 5       // 偽(false)
4 <= 3      // 偽(false)
3 < 4       // 真(true)
```

「===」と「!==」についても補足しておきます。
この2つの演算子は、「値」と「型」を比較します。

---

「型」とは、データの種類のことです。

以下のプログラムを作成して実行してみましょう。

```php
<?php
if ("100" == 100) {
    echo "値が等しい";
}
if ("100" === 100) {
    echo "値と型が等しい";
}
```

結果は以下のようになります。

```text
値が等しい
```

「==」の場合は真(true)となっていますが、「===」の場合は偽(false)になっているのが分かります。

両方とも値は100なので、「==」では等しいと判断されます。

しかし、「文字列」で、右辺は「数値」です。つまり文字列と数値で「型」(データの種類)が異なっているため、偽(false)と判断されます。

このように、型も同じかどうかを比較したい場合は、「===」や「!==」を使用するようにしましょう。

---

## if ~ else文

先ほどのプログラムに処理を追加してみましょう。

最初のif文の例に、スコアが70点未満だった場合は「がんばりましょう。」と出力する処理を追加してみます。

if文を使って書くと以下のようになります。

```php
<?php
$score = 60;
echo "スコアは{$score}点です。<br>";
if ($score >= 70) {
    echo "よくできました。";
}
if ($score < 70) {
    echo "がんばりましょう。";
}
```

このプログラムは「if ~ else文」を使って書くともっと簡単に書くことができます。

elseとは、「それ以外」という意味で、if ~ else文は日本語で説明すると、「 もし○○なら□□する、それ以外なら△ △ する。」となります。


---

if ~ else文をフローチャートで表すと以下のようになります。

![picture 14](/images/c0675d22a8cc1c761d70ad679a018e951e428e068efd5e4373c9489d9d856466.png)  

---

if ~ else文の書き方は以下のようになります。

```php
if (条件式) {
    条件式が真の時の処理
} else {
    条件式が偽の時の処理
}
```

---

最初のif文の例に、スコアが70点未満だった場合は「がんばりましょう。」と出力する処理を追加してみます。

if文を使って書くと以下のようになります。

```php
<?php
$score = 60;
echo "スコアは{$score}点です。<br>";
if ($score >= 70) {
    echo "よくできました。";
} else {
   echo "がんばりましょう。";
}
```

結果

```php
がんばりましょう。
```

---

## if ～ elseif ～ else文

if ~ else文を使用することで、2パターンの処理を実現できるようになりました。

しかし、実際にはもっと複雑な処理をする場合もあります。

例えば、「スコアが80点以上ならA評価」「70点以上ならB評価」「60点以上ならC評価」「それ以外ならD評価」としたい場合はどのようにすればよいでしょう。

---

一つの方法として、elseの処理の中にさらにif文を記述することで実現できます。しかし、この方法だと条件が増えるたびに、if文が入れ子になり、ソースコードが読みづらくなります。

```php
<?php
$score = 75;
echo "スコアは{$score}点です。<br>";
if ($score >= 80) {
    echo "評価はAです。";
} else {
    if ($score >= 70) {
        echo "評価はBです。";
    } else {
       // 60点以上、それ以外の処理
    }
}
```

---

これを簡単に書く方法として、「if ～ elseif ～ else文」があります。
if ～ elseif ～ else文の書き方は以下のようになります。
elseifの条件は何個でも書くことができます。
最後のelseは省略可能です。

```php
if (条件式1) {
    処理
} elseif (条件式2) {
    処理
} else {
    処理
}
```

---

先ほどの処理をif ～ elseif ～ else文で書き直します。

```php
<?php
$score = 75;
echo "スコアは{$score}点です。<br>";
if ($score >= 80) {
    echo "評価はAです。";
} elseif ($score >= 70) {
    echo "評価はBです。";
} elseif ($score >= 60) {
    echo "評価はCです。";
} else {
    echo "評価はDです。";
}
```

結果

```text
結果はBです。
```

if文を入れ子にするよりもスマートに記述できました。


---

最後にif~else if ~else分の注意点について知っておきましょう。

以下のように処理の順番を入れ替えた場合の動きを見てみましょう。


```php
<?php
$score = 85;
echo "スコアは{$score}点です。<br>";
if ($score >= 60) {
    echo "評価はCです。";
} elseif ($score >= 70) {
    echo "評価はBです。";
} elseif ($score >= 80) {
    echo "評価はAです。";
} else {
    echo "評価はDです。";
}
```

結果

```text
スコアは85点です。
評価はCです。
```

---

実行すると、スコアは85点ですが、評価はCになっています。

実はif文は、最初に条件式が真になった場合の処理しか実行されません。先ほどのプログラムの場合は、スコアが60以上の条件が真になり、その処理が実行され、残りの処理は実行されないようになっていました。

つまりこのプログラムでは、評価Bと評価Aの処理は絶対に実行されないプログラムとなっています。

このようなことが起きないように、elseifを使用する際には、条件式を記述する順番に気を付けるようにしましょう。


---

## 論理演算子

今までのプログラムは、条件式の中の条件は一つだけでした。

しかし、実際には複数の条件を満たす場合に処理を実行したい場合もあります。

例えば、英語のスコアと数学のスコア、両方が70点以上の場合に「よくできました。」と表示するにはどうすればよいでしょうか。

以下のようにif文を入れ子にすることで実現できます。


```php
<?php
$englishScore = 73;  // 英語のスコア
$mathScore = 75;     // 数学のスコア
if ($englishScore >= 70) {
    if ($mathScore >= 70) {
        echo "よくできました。";
    }
}
```

しかし、この方法も条件が増えると、ソースコードが複雑になってきます。

「論理演算子」を使うと、一つの条件式の中に複数の条件を記述できるようになります。

---

論理演算子は以下のものになります。

$aと$bには論理値が入っているものとします。


| 論理演算子 | 名前 | 使い方 | 結果 |
|:--:|:--:|:--:|:--:|
|&&|論理積| $a && $b | $a と $bの両方trueの時true |
|and|論理積| $a and $b |$a と $bの両方trueの時true |
| \|\| |論理和| $a \|\| $b |$a と $bのいずれかがtrueの時true |
|or|論理和| $a or $b |$a と $bのいずれかがtrueの時true |
|xor|排他的論理和| $a xor $b |$a と $b片方だけtrueの時true |
|!|否定| !$a | $a がfalseのときtrue|

---

論理演算子を使って、先ほどのプログラムを書き換えると以下のようになります。

if文を入れ子にするよりもすっきり書けるので、論理演算子を有効に活用しましょう。


```php
<?php
$englishScore = 73;
$mathScore = 75;
if ($englishScore >= 70 && $mathScore >= 70) {
    echo "よくできました。";
}
```

---

ちなみに、論理積と論理和の演算子が2つあるのは、それぞれ優先順位が異なるためです。

まずは以下のプログラムを実行してみましょう。「よくできました」が表示されるはずです。


```php
<?php
$englishScore = 60;
$mathScore = 75;
$japaneseScore = 80;
if ($englishScore >= 70 && $mathScore >= 70 || $japaneseScore >= 70) {
    echo "よくできました。";
}
```

結果

```text
よくできました。
```

これは、「$englishScore >= 70 && $mathScore >= 70 」が先に評価され、「false || $japaneseScore >= 70」となります。

「 $japaneseScore 」の値は80で、右辺がtrueのため、全体の評価としては「true」となります。


---

次に、「&&」を「and」に修正しただけの以下のプログラムを実行して確認してみます。

結果は、何も表示されません。


```php
<?php
$englishScore = 60;
$mathScore = 75;
$japaneseScore = 80;
if ($englishScore >= 70 and $mathScore >= 70 || $japaneseScore >= 70) {
    echo "よくできました。";
}
```

これは、

```text
$mathScore >= 70 || $japaneseScore >= 70
```

が先に評価されます。

その結果

```text
$englishScore >= 70 and true
```

となりますが、左辺はfalseとなるため、全体の評価としては「false」となります。


---

ここでは、
**「&&」と「||」は、 「and」と「or」よりも優先度が高い。**
ということを覚えておきましょう。

では、「&&」と「||」ではどちらが優先度が高いでしょうか。

答えは、「&&」の方優先度が高いです。

以下のプログラムを実行してみましょう。

「||」から評価されれば、何も表示されないはずですが、実際には「よくできました」が表示されます。


```php
<?php
$englishScore = 80;
$mathScore = 75;
$japaneseScore = 60;
if ($englishScore >= 70 || $mathScore >= 70 && $japaneseScore >= 70) {
    echo "よくできました。";
}
```

結果

```text
よくできました。
```

---

「||」を先に評価させたい場合には、括弧を使用すると、優先順位を変更して先に評価させることができます。


```php
<?php
$englishScore = 80;
$mathScore = 75;
$japaneseScore = 60;
if (($englishScore >= 70 || $mathScore >= 70) && $japaneseScore >= 70) {
    echo "よくできました。";
}
```

ここでは、
**「&&」と「||」では「&&」の方が優先度が高い。
優先度を変更したい場合は括弧を使用する。**
ということを覚えておきましょう。


そのほか、演算子の細かい優先度に関しては、PHPの公式ドキュメントを参照してください。

---

## 論理値

いままで条件式では比較演算子を使用して論理値を判定していました。
しかし、実は比較演算子を使用しなくても、値だけでの判定もできます。以下のプログラムを作成して実行してみてください。

```php
<?php
if ("abc") 
    echo "abc<br>";

if ("0")   
    echo "0<br>";

if ("")    
    echo "空白<br>";

if (123)   
    echo "123<br>";

if (0.0)   
    echo "0.0<br>";

if (true)  
    echo "true<br>";

if (false) 
    echo "false<br>";

if (null)  
    echo "null<br>";
```

---

結果

```text
abc
123
true
```

条件式の中に値だけを記述してもエラーにはなりません。

また、値によってtrueになるものとfalseになるものがあるのが分かります。

---

まとめると以下のようになります。

* 文字列
  * 空白, "0" ⇒ false
  * それ以外 ⇒ true
* 数値
  * 0, 0.0 ⇒ false
  * それ以外 ⇒ true
* 配列
  * 要素数が0の配列 ⇒ false
  * それ以外 ⇒ true
* 論理値
  * true ⇒ true
  * false ⇒ false
* その他（オブジェクト）
  * null ⇒ false
  * null以外 ⇒ true

---

## 三項演算子

if文を使用せずに簡単な条件判断ができる三項演算子というものがあります。
以下は三項演算子の構文です。

```text
条件式 ? trueの時の式 : falseの時の式;
```

---

例を見ていきましょう。
以下のプログラムを実行してみてください。

$score の値が、70以上の場合は、 $messageに「よくできました。」を代入し、それ以外の場合「がんばりましょう。」を代入する処理になっています。

```php
<?php
$score = 80;
$message = ($score >= 70) ? "よくできました。" : "がんばりましょう。";
echo $message;
```

同じ処理をif文を使って書くと以下のようになります。


```php
<?php
$score = 80;
if ($score >= 70) {
    $message = "よくできました。";
} else {
    $message = "がんばりましょう。";
}
echo $message;
```

---

慣れないうちはif ~ else文の方が読みやすく感じるかもしれません。

しかし、簡単な条件によって変数に代入する値を変えたい場合などに使用されることもあるので、このような書き方ができることを知っておきましょう。


---

## Switch

今までif文を使用して条件分岐する方法を見てきました。
ここで学習するswitch文は、特定の条件下の時に使用することでif文よりもスマートな記述ができる文になります。
特定の条件下とは、「変数が取り得る値があらかじめ決まっている場合」です。
構文は以下のようになります。

```php
switch (式) {
case 値:
    処理
    break;
case 値:
    ・
    ・
    break;
default:
    デフォルト処理
    break;
}
```

---

例を見ていきます。ビンゴ大会を実施します。


* 1位の人は賞金10万円
* 2位の人は賞金5万円
* 3位の人は賞金1万円
* それ以外の人は参加賞1000円

がもらえるものとします。

---

プログラムは以下になります。
「$rank」の値を1～4に切り替えて想定した出力が行われることを確認してください。


```php
<?php
$rank = 1;
switch ($rank) {
  case 1:
    echo "賞金10万円<br>";
    break;
  case 2:
    echo "賞金5万円<br>";
    break;
  case 3:
    echo "賞金1万円<br>";
    break;
  default:
    echo "参加賞1000円<br>";
    break;
}
```

結果

```text
賞金10万円
```

---

次に、breakを省略した場合についてみていきます。
case1の場合のbreakをコメントアウトしてみます。

```php
<?php
$rank = 1;
switch ($rank) {
  case 1:
    echo "賞金10万円<br>";
    // break;  // コメントアウト
  case 2:
    echo "賞金5万円<br>";
    break;
  case 3:
    echo "賞金1万円<br>";
    break;
  default:
    echo "参加賞1000円<br>";
    break;
}
```

結果

```text
賞金10万円
賞金5万円
```

---

エラーにはならずに、処理が実行されました。

結果は、値が2の場合の処理も実行されています。

このように、breakを記述し忘れると、switchの処理が終わらずに次のcaseへ処理が移ってしまいます。

初心者に多いミスですので、breakを書き忘れないように注意しましょう。

---

場合によってはあえてbreakを記述しないようにする場合もあります。

以下の例を見てみましょう。

4位と5位の人は5000円にしたい場合、4の場合に処理やbreakを記述しないようにすることで、うまく処理が実行されます。


```php
<?php
$rank = 4;
switch ($rank) {
  // 1～3は省略
  case 4:
  case 5:
    echo "賞金5000円<br>";
    break;
default:
    echo "参加賞1000円<br>";
    break;
}
```

---

今回の例でみたように、取り得る値があらかじめ決められている場合は、switchを使うことですっきり書くことができます。

使える場面では積極的に使っていきましょう。

今回の例では式は数値による判断をしましたが、文字列で値を判断することも可能です。


switchによる比較は、===での比較が行われます。
つまり、型が一致しているかどうかも判定します。
==と同じ（型が異なっていても値が同じなら同じ）としたい場合にはif文を使用してください。

---

## まとめ

* 条件によって処理を分岐させたいときにはif文かswitch文を使用する。
* ifの条件式では比較演算子を使用して値を比較する。
* 条件が複数ある場合は論理演算子を使用する。
* if ~ elseによって代入の値を変えたい場合は三項演算子で簡潔に書くことができる。
* 変数のとりうる値が固定されている場合にはswitch文を使用する。

---

## 講義動画

[PHP 条件分岐](https://youtu.be/385HLuypChI)
