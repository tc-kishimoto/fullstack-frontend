# オブジェクト指向概要

---

ここではオブジェクト指向の概要について説明します。
オブジェクト指向は、一言で言ってしまえばプログラミングを効率よく行うための考え方のことです。
コンピュータは機械語（0と1）しか認識できません。
しかし、機械語を人間が読み書きするのは困難なため、人間分かりやすくプログラミングできる仕組みとしてプログラミング言語が誕生しました。
それ以降、もっと分かりやすく、そしてもっと効率よく、という思想のもとにどんどん新たな言語が誕生していきました。
オブジェクト指向という考え方が生まれる前の言語（例えばC言語など）でも、今現在も使用されているものもあります。
しかし、オブジェクト指向が使われていない言語で規模の大きなシステムを開発する場合には、効率や分かりやすさといった点でいくつかの問題点がありました（グローバル変数の問題など）。
その問題を解決するために生まれたのがオブジェクト指向という考え方です。

つまり、オブジェクト指向がなくてもプログラミングすることはできるのですが、規模の大きなプログラムを効率よく、かつ分かりやすく開発するために
あると便利なものがオブジェクト指向です。

オブジェクト指向を学ぶ上で知っておくべき基本的な用語があります。

- オブジェクト
- インスタンス
- クラス
- フィールド
- コンストラクタ
- メソッド

以下ではこれらの用語について解説してきます。

## オブジェクト

オブジェクト指向は、その名の通り「オブジェクト」と呼ばれるものに着目した考え方です。
ですので先にオブジェクトについて説明します。
オブジェクトは直訳すると「モノ」です。
それだけだと漠然としていますが、例えば、目の前のパソコンやスマホ、食べ物や飲み物、自分、などなど。
つまり、認識できるモノは全てオブジェクトということになります。
プログラミングの世界では、「クラス」を元に作られるものがオブジェクトとなります。

## インスタンス

オブジェクトと同じ意味で使用されます。
つまり、「クラス」を元に作られたものがインスタンスです。
Javaではクラスから作られたもの、つまりオブジェクトのことをインスタンスと呼びます。
※厳密にはオブジェクトの方がインスタンスよりも広い概念です。
Javaではクラスから作られたものはインスタンスと呼ぶケースの方が多いでしょう。

## クラス

オブジェクトやインスタンスの説明でも出てきました。
また、今までプログラムを作る際にも必ず作ってきました。
ここでようやくクラスについての説明です。
クラスとは、インスタンスを作る元になる設計書のようなものです。
クラスという言葉を直訳すると分類という意味になります。

例えば、自分という存在を何かに分類すると、「人間」「哺乳類」「生き物」「社会人」などに分類できます。
「私」という人間はオブジェクトですが、そのオブジェクトを含む分類、「人間」「生き物」「社会人」などがクラスに相当します。
他、例えば普段使用しているスマホは、「スマホ」「iPhone」「コンピュータ」などに分類できます。
なんとなくイメージできたでしょうか。
つまり、具体的なもの（「私」や「今使用しているスマホ」など）がオブジェクトで、
そのオブジェクトを抽象的なものとして分類したもの（「人間」や「スマホ」など）がクラスです。

## フィールド

続いてはフィールドについてです。
フィールドとは、オブジェクト（インスタンス）の状態を表すものです。
例えば、人間を例として考えたとき、人間には名前や生年月日、性別や国籍など、様々な情報を持っています。
また、その情報は人によって異なります。
このように、人間（クラス）が全員持っていて、個人個人（オブジェクト）によって内容が違うもの。
このデータを保持するものがフィールドです。
実際はクラスの中に宣言された変数です。

※厳密にはフィールドはクラスフィールドとインスタンスフィールドの2つがあります。
ここで説明しているのはインスタンスフィールドのことです。
クラスフィールドについては後の章で説明します。

## コンストラクタ

クラスからインスタンスを生成するタイミングで呼ばれる処理のことをコンストラクタと呼びます。
詳しくは後の章で説明します。

## メソッド

オブジェクトの振る舞い（処理）のことをメソッドと呼びます。
例えば、人間は「歩く」「走る」「話す」などの動作ができます。
しかし、歩く速さや歩き方などは人によって異なります。
このような、オブジェクトによって動作が異なる処理をクラスの中にメソッドとして定義します。

※厳密にはメソッドはインスタンスメソッドとクラスメソッドに分かれます。
ここで説明しているのはインスタンスメソッドの方です。
今まで作成していたmainメソッドなどはクラスメソッドになります。
これらの違いについては後で説明します。

## クラスの定義

ではクラスの定義方法についてみていきます。
クラスを定義する場合、クラス名は必須です。
それ以外のフィールド、コンストラクタ、メソッドは必要に応じて定義します。

構文

```java
public class クラス名 {
    フィールド

    コンストラクタ

    メソッド

}
```

以下は人間を表すクラスの例です。
Ningen.java

```java
package app;

// オブジェクト作成用のクラス
public class Ningen {
    // フィールド
    String name; // 名前
    int age;     // 年齢

    // メソッド
    // ここではstaticはつけない
    public void greet() {
        System.out.println("Hello!");
    }

    // メソッドの中でフィールドの値を使うことも可能
    public void greet2() {
        System.out.println("名前は" + name);
    }
}
```

以下は人間クラスの動作を確認するプログラム。
Main.java

```java
package app;

// 動作確認用
public class Main {

    public static void main(String[] args) {
        // インスタンスの生成
        // クラス名が型になる
        // newというキーワードを使用する
        Ningen n = new Ningen();

        // フィールドの値を参照できる
        // 何もセットしていない場合は初期値がセットされる
        System.out.println(n.name);    // String型(参照型)の場合はnull
        System.out.println(n.age);     // int型の場合は0

        System.out.println("----------");

        // フィールドに値をセットする
        n.name = "Alice";
        n.age = 20;

        // フィールドの値を確認
        System.out.println(n.name);
        System.out.println(n.age);

        System.out.println("----------");

        // メソッドを使用
        n.greet();
        n.greet2();
    }
}
```

結果

```text
null
0
----------
Alice
20
----------
Hello!
名前はAlice
```

### 解説

まず、クラスを利用する際は、そのクラスを型として変数を用意します。
そして、インスタンスを作成する際には「new」というキーワードを使用します。
newによってインスタンスを作成し、そのクラスの型の変数に代入することによって、インスタンスが利用可能になります。
また、フィールドやメソッドを利用する場合は、「変数名.フィールド名、変数名.メソッド名」で利用することが可能です。

構文

```java
クラス名 変数名 = new クラス名();
変数名.フィールド名;  // フィールドへのアクセス
変数名.メソッド名();    // メソッドの利用
```

例

```java
Ningen n = new Ningen();
n.name = "Alice"; // フィールドに値をセット
n.greet();  // メソッドの利用
```

また、フィールドは使い方としては変数と同じですが、
メソッドの中で宣言した変数（このような変数をローカル変数と呼びます）とは異なる点があります。
ローカル変数の場合、変数の値を初期化していない状態で使用を試みるとコンパイルエラーになりますが、
フィールドの場合、値を初期化しなくても、インスタンスが生成された時点で初期値がセットされる仕組みになっています。
数値の場合は0、真偽値の場合はfalse、参照型の場合はnull
の値がセットされる仕組みになっていますので、覚えておきましょう。

## コンストラクタ

ここでコンストラクタについて説明します。
コンストラクタは、インスタンス作成時（newを行った場合）に呼び出される特殊なメソッドです。
主にインスタンスの初期化の目的で作成されます。
コンストラクタにはいくつかのルールがあります。
以下にそれを示します。

- メソッド名はクラス名
- 戻り値はなし（voidも書かない）
- オーバーロードできる）引数が異なればコンストラクタはいくつでも定義できる）
- コンストラクタを1つも定義していない場合、デフォルトコンストラクタが作成される

デフォルトコンストラクタは、処理も引数もないコンストラクタで、
ソースコード上コンストラクタが定義されていない場合に、コンパイル時に自動で作成される。
逆に、コンストラクタを1つでも定義している場合は、デフォルトコンストラクタは作成されない。

以下はコンストラクタを使ったプログラムのサンプルです。

Ningen.java

```java
package app;

// オブジェクト作成用のクラス
public class Ningen {
    // フィールド
    String name; // 名前
    int age;     // 年齢

    // コンストラクタ
    public Ningen() {
        name = "名無し"; // フィールドの名前を設定
        age = 20; // フィールドの年齢を設定
    }

    // メソッド
    public void greet() {
        System.out.println("名前は" + name + "です。年齢は" + age + "歳です。");
    }
}
```

Main.java

```java
package app;

// 動作確認用
public class Main {

    public static void main(String[] args) {
        Ningen n = new Ningen();  // この時コンストラクタが呼ばれる
        n.greet(); // メソッドを呼び出してフィールドの値を確認
    }
}
```

```text
名前は名無しです。年齢は20歳です。
```

newを実行したときにコンストラクタの処理が呼ばれていることが分かります。

続いて引数ありのコンストラクタを定義した場合の例です。

Ningen.java

```java
package app;

// オブジェクト作成用のクラス
public class Ningen {
    // フィールド
    String name; // 名前
    int age;     // 年齢

    // コンストラクタ
    public Ningen(String n, int a) {
        name = n;
        age = a;
    }

    // メソッド
    public void greet() {
        System.out.println("名前は" + name + "です。年齢は" + age + "歳です。");
    }
}
```

Main.java

```java
package app;

public class Main {

    public static void main(String[] args) {
        // コンストラクタの引数に値が渡される
        Ningen n = new Ningen("Alice", 20);

        // この時引数なしでnewを使用とするとコンパイルエラー
        // Ningen n = new Ningen();

        n.greet();
    }
}
```

結果

```text
名前はAliceです。年齢は20歳です。
```

コンストラクタに引数を定義した場合、newする際にクラス名の後で引数に値を渡してあげる必要があります。
引数ありのコンストラクタのみを定義すると、引数なしの状態でnewを行うことができなることに注意しましょう。

## this

メソッドやコンストラクタの中でthisというキーワードを使用できます。
これは、「自分自身」を表すキーワードです。

* this.フィールド名
* this.メソッド名

のように、フィールド名やメソッド名につけて使用します。
また、this単体で使用することもでき、その場合はコンストラクタを表します。

Ningen.java

```java
package app;

public class Ningen {
    // フィールド
    String name; // 名前
    int age;     // 年齢

    // コンストラクタ
    // 引数の変数名をフィールドと同じにすると区別がつかなくなる
    public Ningen(String name, int age) {
        // これだとフィールドに値が入らない
        // name = name;
        // age = age;

        // thisを付けることでフィールドに値がセットされる
        this.name = name;
        this.age = age;
    }

    // 引数なしのコンストラクタ
    public Ningen() {
        // 引数ありのコンストラクタを呼び出す
        this("名無し", 20);
    }

    // メソッド
    public void sayHello() {
        System.out.println("Hello!");
    }
    public void greet() {
        this.sayHello();  // 自分自身のメソッドの呼び出し。
        System.out.println("名前は" + name + "です。年齢は" + age + "歳です。");
    }
}
```

Main.java

```java
package app;

// 動作確認用
public class Main {

    public static void main(String[] args) {
        Ningen n1 = new Ningen("Alice", 20);
        Ningen n2 = new Ningen();
        n1.greet();
        n2.greet();
    }
}
```

結果

```text
Hello!
名前はAliceです。年齢は20歳です。
Hello!
名前は名無しです。年齢は20歳です。
```

### クラスメンバとインスタンスメンバ

フィールドとメソッドのことをまとめてメンバと呼ぶことがあります。
この講義ではここの単元でしか使用しませんが、用語として覚えておきましょう。
メンバにはクラスメンバとインスタンスメソッドがあります。

- クラスメンバ
  - クラスフィールド：クラスが1つだけ持つフィールド（インスタンスに依存しない）
  - クラスメソッド：クラスが1つだけ持つメソッド（インスタンスに依存しない）
- インスタンスメンバ
  - インスタンスフィールド：インスタンスごとに持つフィールド（インスタンスに依存）
  - インスタンスメソッド：インスタンスごとに持つメソッド（インスタンスに依存）

それぞれの使い方として、

インスタンスメンバは

インスタンス名.フィールド名（メソッド名）で使用する。

クラスメンバは

クラス名.フィールド名（メソッド名）で使用する。
(インスタンス名でもアクセスすることはできるが、通常はしない)

以下はクラスメンバとインスタンメンバの違いを確認する例です。

Studnet.java

```java
package app;

public class Student {
    // インスタンスフィールド
    String name;  // 名前
    int score;    // スコア

    // クラスフィールド
    public static int highScore;

    // コンストラクタ
    public Student(String name, int score) {
        this.name = name;
        this.score = score;
    }

    // インスタンスメソッド
    // 自分のスコアが最高得点よりも高い場合は更新する
    public void updateHighScore() {
        if (score > highScore) {
            highScore = score;
        }
    }

    // クラスメソッド
    public static void dispHighScore() {
        System.out.println("最高点は" + highScore + "点です。");
    }
}
```

Main.java

```java
package app;

// 動作確認用
public class Main {

    public static void main(String[] args) {
        // クラスフィールド参照
        System.out.println(Student.highScore);

        // クラスメソッドの使用
        Student.dispHighScore(); // 最高点の表示

        // インスタンス作成
        Student s1 = new Student("Aさん", 75);
        s1.updateHighScore();

        // クラスメソッドの使用
        Student.dispHighScore(); // 最高点の表示

        // インスタンス作成
        Student s2 = new Student("Bさん", 85);
        s2.updateHighScore();

        // クラスメソッドの使用
        Student.dispHighScore();  // 最高点の表示
    }
}
```

結果

```text
0
最高点は0点です。
最高点は75点です。
最高点は85点です。
```

ここではStudentは1つの教室内の生徒を表すクラスです。
生徒の名前やテストの点数はそれぞれ生徒によって異なります。
なのでこの場合インスタンスフィールドとなります。
一方で、テストの最高得点というのはクラス全体で1つだけです。
このように、それぞれの生徒と関係なく、クラス全体として1つの値しか持ちえないものはクラスフィールドとなります。
これはメソッドの場合でも同じです。

また、インスタンスメソッドからは、クラスフィールドやクラスメソッドにアクセスることが可能です。
一方、クラスメソッドからはインスタンスフィールドやインスタンスメソッドにアクセスすることはできません。
合わせて覚えておきましょう。

Studnet.java

```java
public class Student {
    // インスタンスフィールド
    String name;  // 名前
    int score;    // スコア

    // クラスフィールド
    public static int highScore;

    // インスタンスメソッド
    public void updateHighScore() {
        if (score > highScore) {
            highScore = score;
        }
    }

    // インスタンスメソッド
    public void dispScore() {
        System.out.println(name + "のスコアは" + score + "点です。");
        dispHighScore(); // クラスメソッドの呼び出しは可能
    }

    // クラスメソッド
    public static void dispHighScore() {
        // クラスメソッドからインスタンスメソッドは呼び出せない
        // dispScore();
        System.out.println("最高点は" + highScore + "点です。");
    }
}
```

## 定数

通常、変数は一度定義すれば何度でも再代入して値を上書きできます。
しかし、初期化された後に再代入ができない（値の変更ができない）変数を使用したい場合があります。
Javaではそのような再代入できない変数を定義することができ、定数とよびます。
変数を定数にしたい場合には宣言時にfinalというキーワードを付けます。

Student.java

```java
public class Student {
    public static final int MAX_SCORE = 100;
    public static final int MIN_SCORE = 0;

    // 以下略
}
```

Main.java

```java
public class Main {

    public static void main(String[] args) {
        System.out.println(Student.MAX_SCORE);
        System.out.println(Student.MIN_SCORE);
    }
}
```

結果

```text
100
0
```

定数を作成する場合は、一般的にクラスフィールドにします（staticを付ける）。
インスタンスごとに値が変わらないため、クラスで1つだけ持てばよいものです。
そのためstaticを付けてクラスフィールドとするのが一般的です。
また、定数名は、アルファベット大文字で単語をアンダースコアで区切るのが一般的です。
このような名前の付け方をスネークケースと呼びます。
通常の変数と区別するために、このような書き方が推奨されています。

### オブジェクト指向概要まとめ

- オブジェクト指向とはプログラミングを効率化するための考え方
- オブジェクトとは認識できるモノ。クラスとはオブジェクトを抽象化したもの
- クラスから作成されたオブジェクトをインスタンスと呼ぶ
- クラスにはフィールド、メソッド、コンストラクタが定義できる
- フィールドはインスタンスが持つ情報
- メソッドはフィールドの振舞い（処理）
- コンストラクタはインスタンスが作成されたときに呼ばれる特殊なメソッド。主に初期化を目的とする
- thisは自分自身を表すキーワード
- フィールド（メソッド）にstaticを付けるとクラスフィールド（メソッド）になる
- クラスフィールド（メソッド）はクラスが1つだけ持つフィールド（メソッド）
- 再代入できない変数を定数という
- Javaでは定数はfinalを付け、大文字のスネークケースで変数名を定義する

## 講義動画

[オブジェクト指向概要](https://youtu.be/F8DN48WqA6Y)
