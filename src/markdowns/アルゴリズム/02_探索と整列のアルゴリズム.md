# 探索と整列のアルゴリズム

---

# 探索（サーチ）と整列（ソート）

### 探索（サーチ）
以下の数列の中から「2」を探してみましょう。

10　47　50　8　2　15　34

---

簡単に見つけることができるかと思います。

10　47　50　8　**2**　15　34

---

### 整列（ソート）

続いては左から値が小さい順に並び替えてみましょう

10　47　50　8　2　15　34

---

2　8　10　15　34　47　50

こちらも特に深く考えずにできたかと思います。

---

### 探索と整列

人間は視覚的に複数の情報を同時に認識することができるため、この程度の処理は特に深く考えずとも感覚的に処理することができます。
しかし、コンピュータは1つずつ入力データを受け取り、与えられた手順に沿って処理をすることしかできません。
人間には簡単に見えることも、コンピュータに実行させるには厳密にアルゴリズムを考える必要があるのです。

ここからはコンピュータによるデータの探索と並び替えのアルゴリズムについてみていきます。

---

## 探索のアルゴリズム

複数のデータの中から条件に該当する値を探すアルゴリズムを探索（サーチ）といいます。
探索のアルゴリズムとして有名なアルゴリズムには以下の2つがあります。

* 線形探索
  * 探したい値を複数データの先頭の値から順番に比較して探索する方法です
* 二分探索
  * 整列されているデータを使い、探索範囲を狭めながら探索する方法です

---

## 線形探索（リニアサーチ）

線形探索は探索対象となる情報を、探索を行う情報の先頭から順にチェックしていく方法です。

10人分の点数から80点の人を見つけるアルゴリズムを考えてみましょう。

|名前|点数|
|:--|--:|
|山田|85|
|斎藤|100|
|木村|80|
|近藤|75|
|山下|50|
|太田|45|
|小山|80|
|木田|90|
|小林|100|
|松本|85|

---

これは整列されていませんので、線形探索で考えていきます。

まず、点数の情報を配列と呼ばれる連なった変数に格納されている状態で考えます。
以下はdataという変数名で箱に1から始まる番号が振られている状態です。
※この番号のことを添え字、またはインデックスと呼びます。

![picture 17](/images/ea74cb074deef9f851f8b97b188b82583f958e250ca721d5c60b024ae20606f4.png)  

---

まず先頭の値と80を比較し、一致しているかどうかを判定します。
今回の場合は85ですので80ではありません。そのため、次の判定へ進みます。

![picture 18](/images/039d59c07117b60fdd67971580297b45233fb81a3c2911f5f28ef1d32217def6.png)  

---

次の箱に入っている値と80を比較し、一致しているかどうかの判定を行います。
今回の場合は100ですので80ではありません。そのため、次の判定へ進みます。

![picture 19](/images/21c1a7e0658fe4b4b61a8c5546ab5c0bd823ef081c6c032923ba6d67b6982cbf.png)  

---

次の箱に入っている値と80を比較し、一致しているかどうかの判定を行います。今回の場合は80ですので一致しました。
よって80の人は配列の3番の箱の人ということになります。

![picture 20](/images/761a283463a7d4d601096afe3b811449215d9613c53b453b88ee4dd556f5fba1.png)  

---

### フローチャート

フローチャートは以下のようになります。

![picture 21](/images/970bd96f0ca460ed711d7f4a0837b5032bf5db0b6d9e7f240df357f279b23489.png)  

---

**変数の説明**

* data
  * 探索対象の配列
* i 
  * 検索ループ制御用カウンタ
  * 比較対象の添え字として使用する

data[i]が配列のi番目の情報になります。
data[i]=80はi番目の情報が80であるかどうかの判定を行っています。

---

## 二分探索（バイナリサーチ）

二分探索は整列されているデータを使い、探索範囲を狭めながら探索する方法です。
以下の情報は昇順にソートされています。
この中から、二分探索で38を探してみましょう。

![picture 22](/images/2536514d07a1e81f77005508cba719b8b31addd0e2b7237a453bb83c881a2f21.png)  

---

二分探索では探索の範囲を半分に絞っていきます。そのため、整列されていることが前提となります。
まず探索対象の真ん中と探索する値を比較します。

![picture 23](/images/6ad25dfdcff1d1266f1b9e61b2dd9a18b5c0acc23249eb70606072317aadee47.png)  

---

今回の例では38は47よりも小さいので、検索範囲を左側に限定します。

![picture 24](/images/865290b5e6400aadf55e9155dbe214d7e13aafcee7f4d08f18931c86f99a8f14.png)  

---

では右側のことは忘れて、もう一度、新しい探索範囲の真ん中の値と比較を行います。
今度は38より22が小さいので探索範囲の左側には38が無いことが分かります。右側を探していきましょう。

![picture 25](/images/41ad3456197ced1c83f71624de5076aed53e188a0edb4a5f2f44adaee26882ae.png)  

---

残り一つになりましたが、そもそも38が存在しない可能性があります。しっかりと比較しましょう。
38と一致しますので38は3番の箱に入っていることが分かります。

![picture 26](/images/de2785c54354b380530953a7b6f7015156449fbbc5dc0fd89c9dbe094e159e1d.png)  

線形探索を行った場合、最大で7回の比較が必要です（探索する値が78の場合）。
整列されていることが前提となりますが、二分探索では3回の比較で見つけることができます。

---

### フローチャート

今回の二分探索をフローチャートで作成すると以下のようになります。

![picture 27](/images/09cc182f5a51d8b5628157b0a0dc74feafd1ae72ca59d33b1addfa5e4c7a3f36.png)  

---

**変数の説明**

* x
  * 入力値 (探したい値)
* data
  * 探索対象の配列
* i
  * 捜査範囲先頭の添え字
* j
  * 捜査範囲末尾の添え字
* m
  * 比較対象の添え字

---

## 整列のアルゴリズム

複数のデータを昇順、または降順に並べなおすことを整列（ソート）といいます。
整列のアルゴリズムとして有名なアルゴリズムを紹介します。

* 交換法（バブルソート）
  * 隣同士のデータを比較して並べ替えていく方法です
* 選択法
  * 整列範囲で最小（最大）値を見つけ、交換位置（整列範囲の最初のデータ）と交換していく方法です
* 挿入法
  * 整列範囲の最終データを挿入データとし、それより前にあるデータと比較して、適切な位置にデータを挿入していく方法です

---

## 交換法（バブルソート）

交換法を用いて、5人分の点数を昇順に並び替えてみましょう。

整列前

|名前|点数|
|:--|--:|
|山田|68|
|斎藤|82|
|木村|52|
|近藤|100|
|山下|78|

---

整列後

|名前|点数|
|:--|--:|
|木村|52|
|山田|68|
|山下|78|
|斎藤|82|
|近藤|100|

---

まずは全体を整列範囲として処理を行います。
最初に近藤さんと山下さんの点数を比べます。
昇順になっていないので、入れ替えます。

|名前|点数|
|:--|--:|
|山田|68|
|斎藤|82|
|木村|52|
|**山下**|**78**|
|**近藤**|**100**|

---

次に木村さんと山下さんの点数を比べます。昇順になっているので、入れ替えません。

|名前|点数|
|:--|--:|
|山田|68|
|斎藤|82|
|**木村**|**52**|
|**山下**|**78**|
|近藤|100|

---

次に斉藤さんと木村さんの点数を比べます。昇順になっていないので、入れ替えます。

|名前|点数|
|:--|--:|
|山田|68|
|**木村**|**52**|
|**斎藤**|**82**|
|山下|78|
|近藤|100|

---

次に山田さんと木村さんの点数を比べます。昇順になっていないので、入れ替えます。

|名前|点数|
|:--|--:|
|**木村**|**52**|
|**山田**|**68**|
|斎藤|82|
|山下|78|
|近藤|100|

---

これで全体の中で一番点数の低い人を一番上に持って来ることができました。

次は一番上の人(木村)を除いて同じことを行います。
その結果、2番目に点数の低かった人(山田)が2番目まで上がってきます。

|名前|点数|
|:--|--:|
|木村|52|
|山田|68|
|山下|78|
|斎藤|82|
|近藤|100|

---

その次は1番目、2番目の人を除いて同じことを行います
その結果、3番目に点数の低かった人が3番目まで上がってきます。

|名前|点数|
|:--|--:|
|木村|52|
|山田|68|
|山下|78|
|斎藤|82|
|近藤|100|

最終的に比較する対象が無いところまで繰り返すと整列（ソート）が完了します。
交換法はこのように対象が泡のように浮き上がってくることからバブルソートとも呼ばれています。
今回は下から上に移動していきましたが、上から下でも構いませんし、見方によっては左から右という見方もできます。
隣同士のデータを入れ替えるというコンセプトをしっかりと押さえる必要はありますが、型にハマらないようにしましょう。

---

### フローチャート

![picture 2](/images/81c2c141bcd85f8685fe82d9e5d2d49d3aa0464f80ff55c7bdc421ec96cec2e4.png)  

---

**変数の説明**

* data
  * 整列対象の配列
* i
  * iループ (外側のループ) 制御用カウンタ
* j
  * jループ (内側のループ) 制御用カウンタ
  * 配列の値を比較する時の添え字として使用する
  * jループでは、i番目～末尾の範囲で最小の値を、i番目に移動する
* temp
  * 比較した値を入れ替える時に使用する、一時保存場所

---

### やってみよう（手を動かしてバブルソートの理解を深めよう）

* 準備
  * 名刺サイズの白紙を5枚用意しましょう
  * それぞれの紙に1～100までのランダムな数字を記入しましょう
  * 横一列にランダムに並べましょう
* 実践
  * バブルソートのフローチャート通りに紙を動かして数字を並び替えてみよう

---

## 選択法

選択法を用いて、先ほどと同じ5人分の点数を昇順に並び替えてみましょう.

整列前

|名前|点数|
|:--|--:|
|山田|68|
|斎藤|82|
|木村|52|
|近藤|100|
|山下|78|

---

整列後

|名前|点数|
|:--|--:|
|木村|52|
|山田|68|
|山下|78|
|斎藤|82|
|近藤|100|

---

選択法では、まず全体から一番点数の低い人を探索します。
今回の場合、木村さんが該当します。

|名前|点数|
|:--|--:|
|山田|68|
|斎藤|82|
|**木村**|**52**|
|近藤|100|
|山下|78|

---

一番点数の低い人が見つかったら、その人と、一番上の人を入れ替えます。

|名前|点数|
|:--|--:|
|**木村**|**52**|
|斎藤|82|
|**山田**|**68**|
|近藤|100|
|山下|78|

---

次に、1番上の人を除いた4人から1番点数の低い人を探索します。
今回の場合は山田さんが該当します。

|名前|点数|
|:--|--:|
|木村|52|
|斎藤|82|
|**山田**|**68**|
|近藤|100|
|山下|78|

---

1番点数の低い人が見つかったら、その人と、上から2番目の人を入れ替えます。

|名前|点数|
|:--|--:|
|木村|52|
|**山田**|**68**|
|**斎藤**|**82**|
|近藤|100|
|山下|78|

このように、範囲を狭めながら範囲内の1番点数の低い人を探索し、範囲の先頭に移動させていくことで整列を行います。

---

## 挿入法

挿入法を用いて、先ほどと同じ5人分の点数を昇順に並び替えてみましょう。

整列前

|名前|点数|
|:--|--:|
|山田|68|
|斎藤|82|
|木村|52|
|近藤|100|
|山下|78|

---

整列後

|名前|点数|
|:--|--:|
|木村|52|
|山田|68|
|山下|78|
|斎藤|82|
|近藤|100|

---

挿入法では、まず1番上の人だけを見て、整列されている状態と考えます。情報が一つしか無いため、必ず整列されている状態となります。
次に上から2番目の人を見て、1番上の人の上に入るのか、下に入るのかを考えます。
今回の場合、斉藤さんは山田さんよりも点数が高いため、そのままとなります。

|名前|点数|
|:--|--:|
|山田|68|
|**斎藤**|**82**|
|木村|52|
|近藤|100|
|山下|78|

---

続いて、次に上から3番目の人を見て、上2人のどの位置に入るかを考えます。

|名前|点数|
|:--|--:|
|山田|68|
|斎藤|82|
|**木村**|**52**|
|近藤|100|
|山下|78|

---

今回の場合、木村さんは山田さんよりも点数が低いため、山田さん、斉藤さんを一つずつ下げ、一番上に木村さんを入れます。

|名前|点数|
|:--|--:|
|**木村**|**52**|
|山田|68|
|斎藤|82|
|近藤|100|
|山下|78|

---

続いて、次に上から4番目の人を見て、上3人のどの位置に入るかを考えます。
今回の場合、近藤さんは斉藤さんよりも点数が高いため、そのままとなります。

|名前|点数|
|:--|--:|
|木村|52|
|山田|68|
|斎藤|82|
|**近藤**|**100**|
|山下|78|

---

最後に、一番下の人を見て、上4人のどの位置に入るかを考えます。

|名前|点数|
|:--|--:|
|木村|52|
|山田|68|
|斎藤|82|
|近藤|100|
|**山下**|**78**|

---

今回の場合、山下さんは斉藤さんよりも点数が低いため、斉藤さん、近藤さんを一つずつ下げ、斉藤さんの上に山下さんを入れます。
これでソート完了となります。

|名前|点数|
|:--|--:|
|木村|52|
|山田|68|
|**山下**|**78**|
|斎藤|82|
|近藤|100|

---

### フローチャート

フローチャートは下記のようになります。

![picture 3](/images/170e0cbef2de0fb56d569e3dd857119af319bafb163a240067461d42a3d154b3.png)  

---

**変数の説明**

* data
  * 整列対象の配列
* i
  * iループ (外側のループ) 制御用カウンタ
* J
  * jループ (内側のループ) 制御用カウンタ
  * 配列の値を比較する時の添え字として使用する
  * jループでは、i番目の値が1～i番目の範囲でどこに入るかを判断する
* temp
  * 比較した値を入れ替える時に使用する、一時保存場所

---

### やってみよう（手を動かして挿入法の理解を深めよう）

* 準備
  * 名刺サイズの白紙を5枚用意しましょう
  * それぞれの紙に1～100までのランダムな数字を記入しましょう
  * 横一列にランダムに並べましょう

* 実践
  * 挿入法のフローチャート通りに紙を動かして数字を並び替えてみよう

---

### その他のソート

ソートは先に紹介した3つ以外にも様々な種類のソートがあります。
例えば、

* シェルソート
* マージソート
* ヒープソート
* クイックソート

などがあります。
